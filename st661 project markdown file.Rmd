---
title: "Group project"
author: "Jack Hickey"
date: "11/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# {.tabset}
## Introduction 

This project aims to analyze road accident casualties in Ireland from 2005-2018. The analysis will include a variety of comparisons between different kinds of road users, of a range of age groups, across both genders.

__Objective:__ The goal of this project is to determine trends in casualty rates of different cohorts, produce graphical explanations for these trends and ultimately through predictive analysis, determine what directions these trends seem to be heading towards in the future. 

## Cleaning

```{r}
#import
setwd("~/Downloads")
library(pxR)
library(tidyverse)
d<-as.data.frame(read.px("ROA16.px"))
names(d)<-c("Statistic","Year","Road.User.Type","Sex","Age.Group","Value")


str(d)

#check for na's
sapply(d, function(x) which(is.na(x)))

```

## Visual Analysis

```{r}
#male vs female passenger casualties
male_passengers<-subset(d, Road.User.Type=='Car passengers' & Age.Group=='All ages' & Statistic=='All Killed and Injured Casualties (Number)' & Sex=='Male')
female_passengers<-subset(d, Road.User.Type=='Car passengers' & Age.Group=='All ages' & Statistic=='All Killed and Injured Casualties (Number)' & Sex=='Female')
male_female_peddiff<-boxplot(female_passengers$value,male_passengers$value, ylab='Casualties', names=c('Female','Male'), main='Male vs Female passenger casualties',col=c("orange","light blue"))

#boy vs girl passenger casualties
boy_passengers<-subset(d, Road.User.Type=='Car passengers' & Age.Group==c('0 - 5 years','6 - 9 years','10 - 14 years','15 - 17 years') & Statistic=='All Killed and Injured Casualties (Number)' & Sex=='Male')
girl_passengers<-subset(d, Road.User.Type=='Car passengers' & Age.Group==c('0 - 5 years','6 - 9 years','10 - 14 years','15 - 17 years') & Statistic=='All Killed and Injured Casualties (Number)' & Sex=='Female')
boy_girl_peddiff<-boxplot(girl_passengers$value,boy_passengers$value, ylab='Casualties', names=c('Girls','Boys'), main='Boys vs Girl passenger casualties',col=c("orange","light blue"))

#casualties per year for pedal cyclists...trending up!!
x_bike<-subset(d, Statistic=='All Killed and Injured Casualties (Number)' & Road.User.Type=='Pedal cyclists')
x1_bike<-x_bike$value
y_bike<-x_bike$Year
qplot(Year,value, data=x_bike, geom="col",main="Bicyclist total casualties")

#casualties per year for motor cyclists... lowered from 05-13, rising since
x_mbike<-subset(d, Statistic=='All Killed and Injured Casualties (Number)' & Road.User.Type=='Motor cyclists')
x1_mbike<-x_mbike$value
y_mbike<-x_mbike$Year
qplot(Year,value, data=x_mbike, geom="col",main="Motor cyclists total casualties")


```

## Regression and Predictive analysis
```{r}
d<-as.data.frame(read.px("ROA16.px"))

d1<-subset(d, Statistic=="All Killed and Injured Casualties (Number)")
f<-lm(Value~Year+Road.User.Type+Sex+Age.Group, data=d1) 
f
summary(f) #year had no significance

f1<-lm(Value~Road.User.Type+Sex+Age.Group, data=d1)
f1
summary(f1)

#predictive analysis between sex and different road user types
d3<-subset(d1, Statistic=="All Killed and Injured Casualties (Number)" & Road.User.Type=="Car passengers" & Age.Group=="All ages")
f3<-lm(Value~Sex, data=d3)
f3
summary(f3)
anova(f4)
plot(f4, which=2)


d4<-subset(d1, Statistic=="All Killed and Injured Casualties (Number)" & Road.User.Type=="Car drivers" & Age.Group=="All ages")
f4<-lm(Value~Sex, data=d4)
f4
summary(f4)
anova(f4)
plot(f4, which=2)



#From the two linear models (f3 and f4) above we can see a clear pattern for which gender is more injured from different categories..
# for f3: ŷ = b0 + b1x => ŷ = 904.79 + 151.50x where ŷ is the value of the "All killed or injured" statistic for Car passengers, b0 is the Y intercept, ie when females=0, thus this is the predicted value of the male Car passengers, + b1 is the predicted change Value for a change of one in females. This can also be interpreted to say that being a female results in an increase in the casualties value of 151.50 when compared to males for this data.

# for f4:  ŷ = b0 + b1x => ŷ = 1778.8 - 200.5xwhere ŷ is the value of the "All killed or injured" statistic for Car drivers, b0 is the Y intercept, again when females=0. So it can be seen from this linear model that this time the b1 is negative indicating that the female injury value is lower than the males this time.

#So clearly from the linear models here the data interestingly shows that females are much less likely to be killed or injured as drivers but far more likely as passengers. So it is the question to ask are Females better drivers than males (and worse passengers) or is the data simply skewed by the fact that males are far more likely to be the driver and females the passenger and hence they become the statistic for these data points?

#lm of motor cyclists (f5) and pedal cyclists (f6) all ages
d5<-subset(d1, Statistic=="All Killed and Injured Casualties (Number)" & Road.User.Type=="Motor cyclists" & Age.Group=="All ages")
f5<-lm(Value~Sex, data=d5)
f5
summary(f5) #more male motor cyclists predicted

d6<-subset(d1, Statistic=="All Killed and Injured Casualties (Number)" & Road.User.Type=="Pedal cyclists" & Age.Group=="All ages")
f6<-lm(Value~Sex, data=d6)
f6
summary(f6) #more male pedal cyclists predicted

